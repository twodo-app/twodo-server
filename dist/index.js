parcelRequire=function(e,r,n,t){var i="function"==typeof parcelRequire&&parcelRequire,o="function"==typeof require&&require;function u(n,t){if(!r[n]){if(!e[n]){var f="function"==typeof parcelRequire&&parcelRequire;if(!t&&f)return f(n,!0);if(i)return i(n,!0);if(o&&"string"==typeof n)return o(n);var c=new Error("Cannot find module '"+n+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[n][1][r]||r},p.cache={};var l=r[n]=new u.Module(n);e[n][0].call(l.exports,p,l,l.exports,this)}return r[n].exports;function p(e){return u(p.resolve(e))}}u.isParcelRequire=!0,u.Module=function(e){this.id=e,this.bundle=u,this.exports={}},u.modules=e,u.cache=r,u.parent=i,u.register=function(r,n){e[r]=[function(e,r){r.exports=n},{}]};for(var f=0;f<n.length;f++)u(n[f]);if(n.length){var c=u(n[n.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=c:"function"==typeof define&&define.amd?define(function(){return c}):t&&(this[t]=c)}return u}({"S6ww":[function(require,module,exports) {
const e=require("shortid"),t={id:String,title:String,description:String,priority:Number,created:Number,due:Number,estimated:Number,timetaken:Number,snoozed:Boolean,complete:Boolean},r={title:String,description:String,priority:Number,created:Number,due:Number,estimated:Number},i=["id","created","timetaken"],d=e=>Object.keys(r).reduce((t,i)=>typeof e[i]==typeof r[i]()&&t,!0),o=e=>Object.keys(t).reduce((r,i)=>typeof e[i]==typeof t[i]()&&r,!0),a=(e,t)=>i.reduce((r,i)=>e[i]===t[i]&&r,!0),m=t=>({id:e.generate(),title:t.title,description:t.description,priority:t.priority,created:t.created,due:t.due,estimated:t.estimated,timetaken:0,snoozed:!1,complete:!1}),n=()=>m({title:"I am a mock twodo",description:"Use me to test the API!",priority:3*Math.random()|0,created:Date.now(),due:Date.now()+1e5*Math.random(),estimated:Date.now()+1e5*Math.random()});module.exports={validateRequired:d,validateComplete:o,validateUpdate:a,create:m,mock:n};
},{}],"/ZIk":[function(require,module,exports) {
module.exports={OK:200,CREATED:201,NO_CONTENT:204,NOT_MODIFIED:304,BAD_REQUEST:400,UNAUTHORISED:401,FORBIDDEN:403,NOT_FOUND:404,CONFLICT:409,INTERNAL_SERVER_ERROR:500};
},{}],"jx0t":[function(require,module,exports) {
const t=require("shortid"),{OK:e,CREATED:s,BAD_REQUEST:o,NOT_FOUND:r}=require("../status.js"),a=require("../todo.js");module.exports={get:{all:t=>(s,o)=>{const r=t.get("todos").value();o.status(e).json(r)},filtered:t=>(e,s)=>{const o=[];"true"!==e.query.complete&&"false"!==e.query.complete||o.push(t=>t.complete===JSON.parse(e.query.complete)),"true"!==e.query.snoozed&&"false"!==e.query.complete||o.push(t=>t.snoozed===JSON.parse(e.query.snoozed)),isNaN(parseInt(e.query.priority))||o.push(t=>t.priority===parseInt(e.query.priority));const r=o.reduce((t,e)=>t.filter(e),t.get("todos")).value();r.length>0?s.status(200).json(r):s.status(404).json(r)},byID:t=>(s,o)=>{const a=t.get("todos").find({id:s.params.id}).value();null==a?o.status(r).json({}):o.status(e).json(a)}},post:{create:t=>(e,r)=>{if(!e.body)return r.sendStatus(o);if(!a.validateRequired(e.body))return r.sendStatus(o);const d=a.create(e.body);t.get("todos").push(d).write(),r.status(s).json(d)},update:t=>(s,d)=>{const u=t.get("todos").find({id:s.params.id}).value();if(!u)return d.sendStatus(r);if(!s.body)return d.sendStatus(o);if(!a.validateComplete(s.body))return d.sendStatus(o);const n={};for(const t in u)n[t]=s.body.hasOwnProperty(t)?s.body[t]:u[t];if(!a.validateUpdate(n,u))return d.sendStatus(o);t.get("todos").find({id:s.params.id}).assign(u).write(),d.status(e).json(u)}},delete:{byID:t=>(s,o)=>{t.get("todos").remove({id:s.params.id}).write(),o.sendStatus(e)}}};
},{"../status.js":"/ZIk","../todo.js":"S6ww"}],"6KBv":[function(require,module,exports) {
module.exports={todos:require("./todos.js")};
},{"./todos.js":"jx0t"}],"np2C":[function(require,module,exports) {
module.exports={get:{all:s=>(s,e)=>{e.json("This is all the todos")},filtered:s=>(s,e)=>{e.json(`This is all the todos filtered by: ${Object.keys(s.query)}`)},byID:s=>(s,e)=>{e.json(`This is the todo with the id: ${s.params.id}`)}},post:s=>(s,e)=>{}};
},{}],"Ouoj":[function(require,module,exports) {
module.exports={todos:require("./todos.js")};
},{"./todos.js":"np2C"}],"VO5s":[function(require,module,exports) {
const e={test:require("./test/index.js"),v1:require("./v1/index.js")};module.exports=(t=>{switch(t){case"test":return console.log("loading test api"),e.test;case"v1":return console.log("loading v1 api"),e.v1;default:return e.test}});
},{"./test/index.js":"6KBv","./v1/index.js":"Ouoj"}],"Focm":[function(require,module,exports) {
const e=require("express"),o=require("body-parser"),t=require("cors"),s=require("shortid"),r=require("lowdb"),d="test"===process.env.VERSION?require("lowdb/adapters/Memory"):require("lowdb/adapters/FileSync"),i=require("./api/todo.js"),n="db",p=process.env.PORT||3e3,l=process.env.VERSION,u=`/api/${l}`,c=r(new d("db.json"));"test"!==l?c.defaults({todos:[]}).write():c.defaults({todos:[i.mock(),i.mock(),i.mock(),i.mock()]}).write();const a=e();a.use(o.json()),"test"===l&&a.use(t());const q=require("./api")(l);a.get(`${u}/todos`,q.todos.get.all(c)),a.get(`${u}/todos/filter?`,q.todos.get.filtered(c)),a.get(`${u}/todos/:id`,q.todos.get.byID(c)),a.post(`${u}/todos`,q.todos.post.create(c)),a.post(`${u}/todos/:id`,q.todos.post.update(c)),a.delete(`${u}/todos/:id`,q.todos.delete.byID(c)),a.listen(p,"0.0.0.0",()=>{console.log(`Server running on port ${p}`)});
},{"./api/todo.js":"S6ww","./api":"VO5s"}]},{},["Focm"], null)
//# sourceMappingURL=/index.map